<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JOBMAP - Global IAM & Cybersecurity Jobs</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

```
    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
        background: #000;
        color: #fff;
        overflow: hidden;
    }
    
    #globeViz { width: 100vw; height: 100vh; }
    
    /* Header */
    .header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        padding: 1rem 1.5rem;
        background: rgba(0, 0, 0, 0.9);
        backdrop-filter: blur(10px);
        z-index: 100;
        border-bottom: 1px solid rgba(220, 38, 38, 0.3);
    }
    
    .logo {
        font-size: 1.5rem;
        font-weight: bold;
        color: #dc2626;
        letter-spacing: 2px;
    }
    
    /* Stats - Desktop: Left side, Mobile: Top */
    .stats-container {
        position: fixed;
        top: 5rem;
        left: 1rem;
        z-index: 50;
        display: grid;
        gap: 0.8rem;
        max-width: 180px;
    }
    
    .stat-card {
        background: rgba(10, 10, 10, 0.95);
        border: 2px solid rgba(220, 38, 38, 0.5);
        border-radius: 10px;
        padding: 1.2rem 1rem;
        text-align: center;
        backdrop-filter: blur(20px);
        box-shadow: 0 0 25px rgba(220, 38, 38, 0.3);
        cursor: pointer;
        transition: all 0.3s;
    }
    
    .stat-card:hover {
        border-color: rgba(220, 38, 38, 0.9);
        box-shadow: 0 0 35px rgba(220, 38, 38, 0.6);
        transform: scale(1.03);
    }
    
    .stat-number {
        font-size: 2.2rem;
        font-weight: bold;
        color: #ff6b6b;
        margin-bottom: 0.2rem;
    }
    
    .stat-label {
        color: #999;
        font-size: 0.65rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
    
    /* Legend - Bottom left */
    .legend {
        position: fixed;
        bottom: 1rem;
        left: 1rem;
        background: rgba(10, 10, 10, 0.95);
        border: 1px solid rgba(220, 38, 38, 0.3);
        border-radius: 8px;
        padding: 0.8rem;
        backdrop-filter: blur(20px);
        z-index: 50;
        max-width: 140px;
    }
    
    .legend-title {
        color: #ff6b6b;
        font-size: 0.75rem;
        font-weight: bold;
        margin-bottom: 0.4rem;
    }
    
    .legend-item {
        display: flex;
        align-items: center;
        margin: 0.25rem 0;
        font-size: 0.7rem;
        color: #999;
    }
    
    .legend-color {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        margin-right: 0.4rem;
    }
    
    /* Instructions - Bottom right */
    .instructions {
        position: fixed;
        bottom: 1rem;
        right: 1rem;
        color: #777;
        text-align: right;
        z-index: 50;
        font-size: 0.75rem;
        line-height: 1.6;
        max-width: 180px;
    }
    
    /* Jobs View */
    #jobs-view {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #000;
        z-index: 200;
        overflow-y: auto;
        display: none;
        padding-top: 4.5rem;
    }
    
    #jobs-view.active { display: block; }
    
    .jobs-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 1rem;
    }
    
    .jobs-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 1rem;
        margin-bottom: 1.5rem;
        padding: 1.5rem;
        background: rgba(20, 20, 20, 0.95);
        border: 1px solid rgba(220, 38, 38, 0.4);
        border-radius: 10px;
    }
    
    .jobs-header h2 {
        color: #ff6b6b;
        font-size: 1.8rem;
    }
    
    .jobs-header p {
        color: #888;
        font-size: 0.9rem;
    }
    
    .back-btn {
        padding: 0.7rem 1.3rem;
        background: linear-gradient(135deg, #dc2626, #ef4444);
        border: none;
        color: white;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        font-size: 0.9rem;
        transition: all 0.3s;
    }
    
    .back-btn:hover {
        box-shadow: 0 0 20px rgba(220, 38, 38, 0.7);
    }
    
    .jobs-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 1rem;
        padding-bottom: 2rem;
    }
    
    .job-card {
        background: rgba(15, 15, 15, 0.95);
        border: 1px solid rgba(220, 38, 38, 0.3);
        border-left: 3px solid #dc2626;
        border-radius: 8px;
        padding: 1.2rem;
        transition: all 0.3s;
    }
    
    .job-card:hover {
        border-color: rgba(220, 38, 38, 0.7);
        box-shadow: 0 5px 20px rgba(220, 38, 38, 0.4);
        transform: translateY(-3px);
    }
    
    .job-company {
        color: #888;
        font-size: 0.75rem;
        text-transform: uppercase;
        margin-bottom: 0.4rem;
        letter-spacing: 0.5px;
    }
    
    .job-title {
        color: #fff;
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 0.8rem;
        line-height: 1.3;
    }
    
    .job-meta {
        color: #666;
        font-size: 0.8rem;
        margin-bottom: 0.8rem;
        line-height: 1.5;
    }
    
    .job-apply {
        display: inline-block;
        padding: 0.6rem 1.2rem;
        background: linear-gradient(135deg, #dc2626, #ef4444);
        color: white;
        text-decoration: none;
        border-radius: 6px;
        font-weight: 600;
        font-size: 0.85rem;
        transition: all 0.3s;
    }
    
    .job-apply:hover {
        box-shadow: 0 0 15px rgba(220, 38, 38, 0.7);
    }
    
    /* Mobile Responsive */
    @media (max-width: 768px) {
        .header {
            padding: 0.8rem 1rem;
        }
        
        .logo {
            font-size: 1.3rem;
        }
        
        .stats-container {
            top: 4rem;
            left: 0.5rem;
            grid-template-columns: 1fr;
            max-width: 140px;
        }
        
        .stat-card {
            padding: 1rem 0.8rem;
        }
        
        .stat-number {
            font-size: 1.8rem;
        }
        
        .stat-label {
            font-size: 0.6rem;
        }
        
        .legend {
            bottom: 0.5rem;
            left: 0.5rem;
            padding: 0.6rem;
            max-width: 120px;
        }
        
        .legend-title {
            font-size: 0.7rem;
        }
        
        .legend-item {
            font-size: 0.65rem;
        }
        
        .legend-color {
            width: 10px;
            height: 10px;
        }
        
        .instructions {
            display: none;
        }
        
        .jobs-container {
            padding: 0.8rem;
        }
        
        .jobs-header {
            flex-direction: column;
            align-items: flex-start;
            padding: 1rem;
        }
        
        .jobs-header h2 {
            font-size: 1.5rem;
        }
        
        .jobs-grid {
            grid-template-columns: 1fr;
            gap: 0.8rem;
        }
        
        .job-card {
            padding: 1rem;
        }
        
        .job-title {
            font-size: 1rem;
        }
    }
    
    /* Tablet */
    @media (min-width: 769px) and (max-width: 1024px) {
        .stats-container {
            max-width: 160px;
        }
        
        .jobs-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }
</style>
```

</head>
<body>
    <div class="header">
        <div class="logo">üó∫Ô∏è JOBMAP</div>
    </div>

```
<div id="globeViz"></div>

<div class="stats-container">
    <div class="stat-card" onclick="showAllJobs()">
        <div class="stat-number" id="totalJobs">0</div>
        <div class="stat-label">Jobs Worldwide</div>
    </div>
    <div class="stat-card">
        <div class="stat-number" id="totalCountries">0</div>
        <div class="stat-label">Countries</div>
    </div>
    <div class="stat-card" onclick="showRemoteJobs()">
        <div class="stat-number" id="remoteJobs">0</div>
        <div class="stat-label">Remote</div>
    </div>
</div>

<div class="legend">
    <div class="legend-title">Job Density</div>
    <div class="legend-item">
        <div class="legend-color" style="background: #22c55e;"></div>
        <span>High</span>
    </div>
    <div class="legend-item">
        <div class="legend-color" style="background: #f59e0b;"></div>
        <span>Medium</span>
    </div>
    <div class="legend-item">
        <div class="legend-color" style="background: #3b82f6;"></div>
        <span>Low</span>
    </div>
</div>

<div class="instructions">
    üñ±Ô∏è Drag to rotate<br>
    üåç Click country<br>
    üìä Click stats
</div>

<div id="jobs-view">
    <div class="jobs-container">
        <div class="jobs-header">
            <div>
                <h2 id="jobsTitle">Jobs</h2>
                <p><span id="jobsCount">0</span> positions</p>
            </div>
            <button class="back-btn" onclick="backToGlobe()">üåç Back</button>
        </div>
        <div class="jobs-grid" id="jobsGrid"></div>
    </div>
</div>

<script src="//unpkg.com/globe.gl"></script>
<script>
    let myGlobe, allJobs = [];
    
    const NORMALIZE = {
        'United States of America': 'United States of America',
        'United States': 'United States of America',
        'USA': 'United States of America',
        'US': 'United States of America',
        'United Kingdom': 'United Kingdom',
        'UK': 'United Kingdom',
        'Canada': 'Canada',
        'Australia': 'Australia',
        'Germany': 'Germany',
        'France': 'France',
        'India': 'India',
        'Singapore': 'Singapore',
        'Netherlands': 'Netherlands',
        'Switzerland': 'Switzerland',
        'Spain': 'Spain',
        'Italy': 'Italy',
        'Brazil': 'Brazil',
        'Mexico': 'Mexico'
    };
    
    async function init() {
        await loadJobs();
        createGlobe();
    }
    
    async function loadJobs() {
        try {
            const r = await fetch('data/jobs.json');
            const d = await r.json();
            allJobs = d.jobs;
            updateStats();
        } catch (e) {
            console.error(e);
        }
    }
    
    function updateStats() {
        document.getElementById('totalJobs').textContent = allJobs.length;
        document.getElementById('remoteJobs').textContent = allJobs.filter(j => j.locationType === 'remote').length;
        
        const c = new Set();
        allJobs.forEach(j => {
            const p = j.location.split(', ');
            const co = p[p.length - 1];
            if (!co.includes('Remote')) c.add(NORMALIZE[co] || co);
        });
        document.getElementById('totalCountries').textContent = c.size;
    }
    
    function createGlobe() {
        fetch('https://raw.githubusercontent.com/vasturiano/globe.gl/master/example/datasets/ne_110m_admin_0_countries.geojson')
            .then(r => r.json())
            .then(countries => {
                const jbc = {};
                allJobs.forEach(j => {
                    const p = j.location.split(', ');
                    let c = p[p.length - 1];
                    if (!c.includes('Remote')) {
                        c = NORMALIZE[c] || c;
                        jbc[c] = (jbc[c] || 0) + 1;
                    }
                });
                
                countries.features.forEach(d => {
                    const n = d.properties.ADMIN || d.properties.NAME;
                    d.properties.jobs = jbc[n] || 0;
                });
                
                const isMobile = window.innerWidth < 768;
                
                myGlobe = Globe()(document.getElementById('globeViz'))
                    .globeImageUrl('//unpkg.com/three-globe/example/img/earth-blue-marble.jpg')
                    .bumpImageUrl('//unpkg.com/three-globe/example/img/earth-topology.png')
                    .backgroundImageUrl('//unpkg.com/three-globe/example/img/night-sky.png')
                    .polygonsData(countries.features)
                    .polygonAltitude(0.01)
                    .polygonCapColor(d => {
                        const j = d.properties.jobs || 0;
                        if (j === 0) return 'rgba(80, 80, 80, 0.4)';
                        if (j >= 10) return 'rgba(34, 197, 94, 0.85)';
                        if (j >= 5) return 'rgba(245, 158, 11, 0.85)';
                        return 'rgba(59, 130, 246, 0.85)';
                    })
                    .polygonSideColor(() => 'rgba(220, 38, 38, 0.15)')
                    .polygonStrokeColor(() => 'rgba(220, 38, 38, 0.4)')
                    .polygonLabel(d => {
                        const n = d.properties.ADMIN || d.properties.NAME;
                        const j = d.properties.jobs || 0;
                        return '<div style="background: rgba(0,0,0,0.95); padding: 10px; border-radius: 6px; border: 2px solid #dc2626;"><b style="color: #ff6b6b; font-size: 14px;">' + n + '</b><br/><span style="color: #aaa; font-size: 12px;">' + j + ' job' + (j !== 1 ? 's' : '') + '</span></div>';
                    })
                    .onPolygonClick(d => {
                        const n = d.properties.ADMIN || d.properties.NAME;
                        const j = d.properties.jobs || 0;
                        if (j > 0) selectCountry(n);
                    })
                    .onPolygonHover(d => {
                        const j = (d && d.properties) ? d.properties.jobs : 0;
                        document.body.style.cursor = (d && j > 0) ? 'pointer' : 'default';
                    })
                    .atmosphereColor('#ff4444')
                    .atmosphereAltitude(isMobile ? 0.12 : 0.15)
                    .pointOfView({ altitude: isMobile ? 3 : 2.5 })
                    .width(window.innerWidth)
                    .height(window.innerHeight);
                
                myGlobe.controls().autoRotate = true;
                myGlobe.controls().autoRotateSpeed = isMobile ? 0.3 : 0.5;
                myGlobe.controls().enableZoom = !isMobile;
            });
    }
    
    function selectCountry(geoName) {
        const jobs = allJobs.filter(j => {
            const p = j.location.split(', ');
            const c = p[p.length - 1];
            return (NORMALIZE[c] || c) === geoName;
        });
        
        if (jobs.length > 0) displayJobs(jobs, geoName);
    }
    
    function showAllJobs() {
        displayJobs(allJobs, 'All Global Opportunities');
    }
    
    function showRemoteJobs() {
        displayJobs(allJobs.filter(j => j.locationType === 'remote'), 'Remote Positions');
    }
    
    function displayJobs(jobs, title) {
        document.getElementById('jobsTitle').textContent = title;
        document.getElementById('jobsCount').textContent = jobs.length;
        
        let html = '';
        jobs.forEach(job => {
            const company = String(job.company || '').replace(/</g, '&lt;');
            const jtitle = String(job.title || '').replace(/</g, '&lt;');
            const loc = String(job.location || '').replace(/</g, '&lt;');
            
            html += '<div class="job-card">';
            html += '<div class="job-company">' + company + '</div>';
            html += '<div class="job-title">' + jtitle + '</div>';
            html += '<div class="job-meta">üìç ' + loc;
            
            if (job.locationType === 'remote') html += ' ‚Ä¢ üè† Remote';
            else if (job.locationType === 'hybrid') html += ' ‚Ä¢ üîÑ Hybrid';
            else html += ' ‚Ä¢ üè¢ Onsite';
            
            if (job.visaSponsorship === 'available') html += ' ‚Ä¢ üõÇ Visa';
            if (job.clearance && job.clearance !== 'none') html += ' ‚Ä¢ üîí ' + job.clearance.toUpperCase();
            
            html += '</div>';
            html += '<a href="' + job.url + '" target="_blank" class="job-apply">Apply Now ‚Üí</a>';
            html += '</div>';
        });
        
        document.getElementById('jobsGrid').innerHTML = html;
        document.getElementById('jobs-view').classList.add('active');
    }
    
    function backToGlobe() {
        document.getElementById('jobs-view').classList.remove('active');
        if (myGlobe) myGlobe.controls().autoRotate = true;
    }
    
    window.addEventListener('resize', () => {
        if (myGlobe) myGlobe.width(window.innerWidth).height(window.innerHeight);
    });
    
    window.addEventListener('load', init);
</script>
```

</body>
</html>
